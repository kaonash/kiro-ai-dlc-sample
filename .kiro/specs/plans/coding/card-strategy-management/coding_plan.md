# カード・戦略管理ユニット 実装計画

## 概要
カード・戦略管理ユニットのコンポーネントモデルとユニット仕様に基づいて、TypeScript + Bun + TDD/DDDの原則に従って実装を行います。

## 前提条件
- コンポーネントモデル（component_model.md）が完成済み
- ユニット仕様（unit.md）が完成済み
- TypeScript + Bun技術スタック
- TDD（t-wadaスタイル）+ DDD（エリック・エヴァンススタイル）原則
- Biomeによるコード品質チェック

## 実装ステップ

### フェーズ1: プロジェクト基盤構築
- [x] **ステップ1**: プロジェクト構造の作成
  - TypeScript + Bunプロジェクトの初期化
  - 必要なディレクトリ構造の作成（src/domain, src/application, src/infrastructure, tests/）
  - package.json、tsconfig.json、biome.json等の設定ファイル作成

- [x] **ステップ2**: 開発環境の設定
  - Bunの依存関係インストール
  - テストフレームワーク（Bun Test）の設定
  - Biomeによるリンター・フォーマッター設定
  - 基本的なビルド・テストスクリプトの作成

### フェーズ2: ドメインモデル実装（TDD）
- [x] **ステップ3**: 値オブジェクトの実装
  - CardCost値オブジェクトのテスト作成と実装
  - TowerType列挙型のテスト作成と実装
  - SpecialAbility列挙型のテスト作成と実装

- [x] **ステップ4**: エンティティの実装
  - Cardエンティティのテスト作成と実装
  - Handエンティティのテスト作成と実装
  - CardPoolエンティティのテスト作成と実装
  - CardLibraryエンティティのテスト作成と実装

- [x] **ステップ5**: 集約ルートの実装
  - GameSessionエンティティ（集約ルート）のテスト作成と実装
  - 集約内の整合性制約の実装

### フェーズ3: ドメインサービス実装（TDD）
- [x] **ステップ6**: ドメインサービスの実装
  - CardSelectionServiceのテスト作成と実装
  - CardPlayValidationServiceのテスト作成と実装
  - CardDiscoveryServiceのテスト作成と実装

### フェーズ4: インフラストラクチャ層実装（TDD）
- [x] **ステップ7**: データ永続化の実装
  - ローカルストレージ用CardLibraryRepositoryのテスト作成と実装
  - カードデータ読み込み用CardPoolRepositoryのテスト作成と実装

### フェーズ5: アプリケーション層実装（TDD）
- [x] **ステップ8**: ユースケースの実装
  - ゲーム開始時のカード配布ユースケースのテスト作成と実装
  - カードプレイ検証ユースケースのテスト作成と実装
  - カードライブラリ更新ユースケースのテスト作成と実装

### フェーズ6: 設定・データファイル作成
- [x] **ステップ9**: 設定ファイルの作成
  - cards.json（30種類以上のカードデータ）の作成
  - game-config.jsonの作成
  - カードバランス調整用の設定値定義

### フェーズ7: 統合テスト・品質保証
- [ ] **ステップ10**: 統合テストの実装
  - カード配布フローの統合テスト
  - カードプレイフローの統合テスト
  - 永続化機能の統合テスト

- [ ] **ステップ11**: コード品質チェック
  - Biomeによるリンター・フォーマッターの実行
  - テストカバレッジの確認
  - パフォーマンステストの実行

### フェーズ8: 最終検証・文書化
- [ ] **ステップ12**: 受入基準の検証
  - 各ユーザーストーリーの受入基準に対するテスト実行
  - エラーハンドリングの動作確認
  - パフォーマンス要件の確認

- [ ] **ステップ13**: 実装文書の作成
  - README.mdの作成（セットアップ手順、使用方法）
  - API仕様書の作成
  - トラブルシューティングガイドの作成

## 確認が必要な事項

### 1. プロジェクト構造
- **質問**: プロジェクトのルートディレクトリ名は何にしますか？（例：tower-defense-card-game）
- **質問**: Clean Architecture + DDDの標準的なディレクトリ構造で良いですか？

### 2. 技術的詳細
- **質問**: テストフレームワークはBun Testで良いですか？他の選択肢（Jest、Vitest等）は必要ですか？
- **質問**: カードデータの管理方法はJSONファイルで良いですか？将来的なDB移行を考慮した設計にしますか？

### 3. 外部依存関係
- **質問**: タワー配置システム、UIシステムとの連携はモック実装で進めて良いですか？
- **質問**: ドラッグ&ドロップ機能のUI部分は今回の実装範囲外で良いですか？

### 4. カードデータ仕様
- **質問**: 30種類のカードデータの具体的な内容は自動生成で良いですか？特定の要望はありますか？
- **質問**: カードバランス調整の基準値は仮の値で設定して良いですか？

## 成果物
- TypeScript + Bunプロジェクト
- 完全なテストスイート（単体テスト + 統合テスト）
- カード・戦略管理ユニットの完全な実装
- 設定ファイル（cards.json、game-config.json）
- 実装文書（README.md、API仕様書等）

## 次のステップ
この計画の承認後、ステップ1から順次実行し、各ステップ完了時にチェックボックスを更新します。