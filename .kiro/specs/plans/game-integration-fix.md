# ゲーム統合修正計画

## 問題の概要

現在のタワーディフェンスゲームで以下の問題が発生している：

1. **敵が出現しない**: 敵生成システムがメインゲームループに統合されていない
2. **タワーが配置できない**: タワー配置システムがゲームに統合されていない
3. **ゲームフィールドが機能しない**: UIは表示されるが実際のゲームロジックが動作しない

## 修正計画

### フェーズ1: 敵生成システムの統合

#### ステップ1.1: WaveSchedulerをGameSessionに統合
- `GameSession`に`WaveScheduler`を追加
- ゲームループで敵生成を処理
- 敵の移動と状態管理を実装

#### ステップ1.2: 敵の描画システム実装
- `GameRenderer`に敵描画機能を追加
- 敵の移動アニメーション実装
- 敵の体力表示機能

### フェーズ2: タワー配置システムの統合

#### ステップ2.1: TowerPlacementServiceをGameSessionに統合
- `GameSession`に`TowerPlacementService`を追加
- カード使用時のタワー配置処理を実装
- タワーの配置可能位置判定

#### ステップ2.2: タワーの描画と戦闘システム
- `GameRenderer`にタワー描画機能を追加
- タワーの攻撃処理実装
- 攻撃エフェクトの表示

### フェーズ3: ゲームフィールドの機能実装

#### ステップ3.1: 入力処理の改善
- マウスクリック位置の正確な判定
- カード選択とタワー配置の連携
- UI要素との適切な相互作用

#### ステップ3.2: ゲーム状態の同期
- UI表示とゲーム状態の同期
- リアルタイムでの情報更新
- エラーハンドリングの改善

## 実装優先度

1. **高優先度**: 敵生成システムの統合（ゲームの基本機能）
2. **高優先度**: タワー配置システムの統合（プレイヤーの主要操作）
3. **中優先度**: 描画システムの改善（視覚的フィードバック）
4. **低優先度**: UI/UXの細かい調整

## 成功基準

- [ ] ゲーム開始時に敵が自動的に出現する
- [ ] カードをクリックしてゲームフィールドをクリックするとタワーが配置される
- [ ] タワーが敵を自動的に攻撃する
- [ ] 敵が基地に到達するとダメージを受ける
- [ ] ゲーム終了条件が正常に動作する

## 推定作業時間

- フェーズ1: 2-3時間
- フェーズ2: 2-3時間  
- フェーズ3: 1-2時間
- 合計: 5-8時間

## リスク要因

- 既存のコードとの統合時の互換性問題
- パフォーマンスの問題（多数の敵とタワーの処理）
- UI要素の座標系の不整合