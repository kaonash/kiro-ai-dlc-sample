# タワー・戦闘システムユニット

## ユニット概要

**責任**: タワー配置、戦闘ロジック、ダメージ計算  
**技術的境界**: タワー管理、戦闘エンジン、ターゲティング  
**外部依存**: 敵システム（ユニット4）、UIシステム（ユニット5）

## 含まれるユーザーストーリー

### ストーリー3.1: 多様なタワー特性
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、異なる特性とトレードオフを持つタワーを使い分けたい。そうすることで、状況に応じた戦略的な判断を楽しむことができる。

**受入基準**:
1. 「強力だが遅い」タワーは、配置後に有効化までの待機時間があり、その後高ダメージを与えなければならない
2. 「高ダメージだが脆弱」タワーは、遠距離では強力だが、近距離の敵に弱くなければならない
3. 「高速だが低ダメージ」タワーは、連続攻撃で多数の弱い敵に効果的でなければならない
4. 各タワータイプの特性は、視覚的なデザインと説明文で明確に区別されなければならない

**要件トレーサビリティ**: 要件4

### ストーリー3.2: 自動戦闘システム
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、タワーが自動的に敵を攻撃することを望む。そうすることで、マイクロマネジメントではなく戦略的な配置とタイミングに集中できる。

**受入基準**:
1. 敵がタワーの射程に入るとき、システムは自動的に最適なターゲットを選択し攻撃を開始しなければならない
2. 複数の敵が射程内にいるとき、システムは「最も近い敵優先」のターゲティングを適用しなければならない
3. タワーが敵を倒すとき、システムはスコアを加算し、視覚的な報酬エフェクトを表示しなければならない
4. 攻撃時に、システムは射撃エフェクト、命中エフェクト、ダメージ数値を表示しなければならない

**要件トレーサビリティ**: 要件6

## ユニット間インターフェース

### 提供するサービス
- タワー配置・管理
- 戦闘ロジック実行
- ダメージ計算
- ターゲティングシステム
- スコア加算通知

### 依存するサービス
- 敵システム（ユニット4）: 敵の位置・状態情報、ダメージ適用
- カード・戦略管理（ユニット2）: カードからタワーへの変換仕様
- UI・フィードバックシステム（ユニット5）: 戦闘エフェクト表示
- ゲームセッション管理（ユニット1）: スコア更新

## 実装上の考慮事項

- リアルタイム戦闘処理のパフォーマンス
- 複数タワーの同時戦闘処理
- ターゲティングアルゴリズムの効率性
- タワー特性の拡張性
- 戦闘状態の一貫性保証
- 射程・ダメージ計算の精度