# ユーザーストーリー

## 概要

このドキュメントは、タワーディフェンスカードゲームの要件定義書に基づいて作成されたユーザーストーリーを定義します。各ストーリーはカジュアルゲーマーの視点から記述され、3分間の短時間プレイセッションでの戦略的な楽しさとリプレイ性を重視しています。

## ユーザーペルソナ

**プライマリユーザー**: カジュアルゲーマー
- 短時間（3分程度）でゲームを楽しみたい
- 戦略的思考を楽しむが、複雑すぎるルールは好まない
- リプレイ性と新しい発見を重視する
- 即座のフィードバックと視覚的な満足感を求める

## ユーザーストーリー

### エピック1: ゲームセッション管理

#### ストーリー1.1: クイックゲームセッション開始
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、ワンクリックで3分間のゲームセッションを開始したい。そうすることで、忙しいスケジュールの合間に手軽にゲームを楽しむことができる。

**受入基準**:
1. プレイヤーが「新しいゲーム」ボタンをクリックするとき、システムは即座に3分タイマー付きのゲームセッションを開始しなければならない
2. ゲームタイマーが画面上に明確に表示され、リアルタイムでカウントダウンされなければならない
3. ゲーム開始時に、システムはプレイヤーに基本的なゲーム状態（体力、スコア、手札）を表示しなければならない

**要件トレーサビリティ**: 要件1

#### ストーリー1.2: ゲーム終了とスコア表示
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、ゲーム終了時に自分のパフォーマンスを明確に確認したい。そうすることで、次回のプレイでの改善点を理解し、達成感を得ることができる。

**受入基準**:
1. 3分タイマーがゼロに達するとき、システムは自動的にゲームを終了し結果画面を表示しなければならない
2. プレイヤーの体力がゼロになるとき、システムは敗北画面を表示し、生存時間とスコアを表示しなければならない
3. 結果画面では、最終スコア、倒した敵の数、使用したカード数、生存時間を表示しなければならない
4. 結果画面から新しいゲームを開始するオプションを提供しなければならない

**要件トレーサビリティ**: 要件1, 要件5

### エピック2: カード・戦略システム

#### ストーリー2.1: ランダムカード配布
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、毎回異なる8枚のカードでゲームを開始したい。そうすることで、毎回新しい戦略的チャレンジを楽しみ、ゲームのリプレイ性を体験できる。

**受入基準**:
1. 新しいゲームが開始されるとき、システムは30種類以上のカードプールから8枚をランダムに選択しなければならない
2. 選択された8枚のカードに重複があってはならない
3. カードは手札エリアに視覚的に魅力的な形で表示されなければならない
4. 各カードにはコスト、タワータイプ、特殊能力が明確に表示されなければならない

**要件トレーサビリティ**: 要件2, 要件7

#### ストーリー2.2: 魔力システムによるリソース管理
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、時間経過で蓄積される魔力を使ってカードをプレイしたい。そうすることで、リソース管理の戦略的判断を楽しみながら、タイミングを考慮した戦術的なプレイができる。

**受入基準**:
1. ゲーム開始時に、プレイヤーは初期魔力（例：10ポイント）を持ってスタートしなければならない
2. 時間経過とともに、システムは1秒ごとに魔力を1ポイント増加させなければならない
3. 魔力の現在値と最大値（99ポイント）が画面上に明確に表示されなければならない
4. 各カードには魔力コスト（3-30ポイント）が設定され、カード上に表示されなければならない

**要件トレーサビリティ**: 要件3

#### ストーリー2.3: 戦略的カードプレイ
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、十分な魔力がある時にカードを戦場の適切な位置にドラッグ&ドロップで配置したい。そうすることで、直感的な操作で戦略的な防御ラインを構築できる。

**受入基準**:
1. プレイヤーがカードを戦場にドラッグするとき、システムは配置可能な位置をハイライト表示しなければならない
2. 魔力が不足している場合、システムはカードを半透明表示し、ドラッグを無効化しなければならない
3. 十分な魔力があり有効な位置にカードをドロップするとき、システムは魔力コストを消費し、対応するタワーを即座に配置し、カードを手札から除去しなければならない
4. 無効な位置にドロップしようとするとき、システムは視覚的フィードバックでエラーを示し、カードを手札に戻さなければならない
5. タワー配置時に、システムは配置アニメーション、魔力消費エフェクト、音響エフェクトを再生しなければならない

**要件トレーサビリティ**: 要件3

#### ストーリー2.4: 多様なカードタイプの発見
**優先度**: 中

**ユーザーストーリー**: カジュアルゲーマーとして、プレイを重ねることで新しいカードタイプとその戦略的価値を発見したい。そうすることで、長期的な学習と成長の楽しさを体験できる。

**受入基準**:
1. システムは最低30種類の異なるカードタイプを提供しなければならない
2. 各カードタイプは独自の特性、魔力コスト（3-30ポイント）、戦略的価値を持たなければならない
3. 新しいカードに初めて遭遇するとき、システムは詳細な説明とヒントを表示しなければならない
4. カードライブラリ機能で、プレイヤーは遭遇したすべてのカードを確認できなければならない

**要件トレーサビリティ**: 要件7

### エピック3: タワー・戦闘システム

#### ストーリー3.1: 多様なタワー特性
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、異なる特性とトレードオフを持つタワーを使い分けたい。そうすることで、状況に応じた戦略的な判断を楽しむことができる。

**受入基準**:
1. 「強力だが高コスト」タワーは、高い魔力コスト（20-30ポイント）を要求するが、配置後即座に高ダメージを与えなければならない
2. 「高ダメージだが脆弱」タワーは、遠距離では強力だが、近距離の敵に弱く、配置後即座に有効化されなければならない
3. 「高速だが低ダメージ」タワーは、低い魔力コスト（3-8ポイント）で配置でき、連続攻撃で多数の弱い敵に効果的でなければならない
4. 各タワータイプの特性と魔力コストは、視覚的なデザインと説明文で明確に区別されなければならない

**要件トレーサビリティ**: 要件4

#### ストーリー3.2: 自動戦闘システム
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、タワーが自動的に敵を攻撃することを望む。そうすることで、マイクロマネジメントではなく戦略的な配置とタイミングに集中できる。

**受入基準**:
1. 敵がタワーの射程に入るとき、システムは自動的に最適なターゲットを選択し攻撃を開始しなければならない
2. 複数の敵が射程内にいるとき、システムは「最も近い敵優先」のターゲティングを適用しなければならない
3. タワーが敵を倒すとき、システムはスコアを加算し、視覚的な報酬エフェクトを表示しなければならない
4. 攻撃時に、システムは射撃エフェクト、命中エフェクト、ダメージ数値を表示しなければならない

**要件トレーサビリティ**: 要件6

### エピック4: 敵・チャレンジシステム

#### ストーリー4.1: 敵の波による挑戦
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、段階的に難しくなる敵の波に挑戦したい。そうすることで、緊張感のある戦略的ゲームプレイを体験できる。

**受入基準**:
1. ゲーム開始から定期的な間隔で、システムは敵の波を生成しなければならない
2. 敵は事前定義されたパスに従ってプレイヤーの基地に向かって移動しなければならない
3. 敵がプレイヤーの基地に到達するとき、システムはプレイヤーの体力を減少させなければならない
4. 時間経過とともに、敵の強さ、数、種類が増加しなければならない

**要件トレーサビリティ**: 要件5

### エピック5: UI・フィードバックシステム

#### ストーリー5.1: 即座の視覚・音響フィードバック
**優先度**: 中

**ユーザーストーリー**: カジュアルゲーマーとして、自分のアクションに対する即座で満足感のあるフィードバックを受けたい。そうすることで、ゲームが反応的で魅力的に感じられる。

**受入基準**:
1. タワー配置時に、システムは配置アニメーション、音響エフェクト、視覚的確認を提供しなければならない
2. タワーの攻撃時に、システムは射撃アニメーション、命中エフェクト、ダメージ表示を提供しなければならない
3. 敵撃破時に、システムは破壊エフェクト、スコア加算アニメーション、報酬音を再生しなければならない
4. 重要なイベント（敵の波開始、体力減少、ゲーム終了）で適切な音響キューを提供しなければならない

**要件トレーサビリティ**: 要件8

#### ストーリー5.2: 明確なゲーム状態表示
**優先度**: 高

**ユーザーストーリー**: カジュアルゲーマーとして、現在のゲーム状況を一目で把握したい。そうすることで、情報に基づいた迅速な戦略的判断を行うことができる。

**受入基準**:
1. 画面上部に、残り時間、現在の体力、現在のスコア、現在の魔力値が常に表示されなければならない
2. 手札エリアに、利用可能なカードとその魔力コスト、詳細情報が明確に表示されなければならない
3. 戦場上の敵の位置、体力バー、移動方向が視覚的に分かりやすく表示されなければならない
4. 配置されたタワーの射程、状態、現在のターゲットが必要に応じて表示されなければならない

**要件トレーサビリティ**: 要件9

## 要件トレーサビリティマトリックス

| ユーザーストーリー | 対応要件 | 優先度 |
|---|---|---|
| ストーリー1.1: クイックゲームセッション開始 | 要件1 | 高 |
| ストーリー1.2: ゲーム終了とスコア表示 | 要件1, 要件5 | 高 |
| ストーリー2.1: ランダムカード配布 | 要件2, 要件7 | 高 |
| ストーリー2.2: 魔力システムによるリソース管理 | 要件3 | 高 |
| ストーリー2.3: 戦略的カードプレイ | 要件3 | 高 |
| ストーリー2.4: 多様なカードタイプの発見 | 要件7 | 中 |
| ストーリー3.1: 多様なタワー特性 | 要件4 | 高 |
| ストーリー3.2: 自動戦闘システム | 要件6 | 高 |
| ストーリー4.1: 敵の波による挑戦 | 要件5 | 高 |
| ストーリー5.1: 即座の視覚・音響フィードバック | 要件8 | 中 |
| ストーリー5.2: 明確なゲーム状態表示 | 要件9 | 高 |

## 次のステップ

これらのユーザーストーリーは、AI-DLC手法に従ってユニットに分解され、実装計画の基礎となります。
## ユニット分解（AI-DLC準拠）

AI-DLC手法に従い、高凝集で疎結合なユニットに分解します。各ユニットは独立してデプロイ可能で、明確な責任境界を持ちます。

### ユニット1: ゲームセッション管理ユニット
**責任**: ゲームライフサイクル、タイマー、スコア管理、魔力システム
**含まれるストーリー**:
- ストーリー1.1: クイックゲームセッション開始
- ストーリー1.2: ゲーム終了とスコア表示
- ストーリー2.2: 魔力システムによるリソース管理

**技術的境界**: ゲーム状態管理、セッション制御、結果計算、魔力管理
**外部依存**: なし（独立ユニット）

### ユニット2: カード・戦略管理ユニット  
**責任**: カード配布、手札管理、カードプレイロジック
**含まれるストーリー**:
- ストーリー2.1: ランダムカード配布
- ストーリー2.3: 戦略的カードプレイ
- ストーリー2.4: 多様なカードタイプの発見

**技術的境界**: カードデータ管理、ランダム生成、プレイ検証、魔力コスト管理
**外部依存**: タワー配置システム（ユニット3）、魔力システム（ユニット1）

### ユニット3: タワー・戦闘システムユニット
**責任**: タワー配置、戦闘ロジック、ダメージ計算
**含まれるストーリー**:
- ストーリー3.1: 多様なタワー特性
- ストーリー3.2: 自動戦闘システム

**技術的境界**: タワー管理、戦闘エンジン、ターゲティング
**外部依存**: 敵システム（ユニット4）、UI システム（ユニット5）

### ユニット4: 敵・チャレンジシステムユニット
**責任**: 敵生成、移動、基地攻撃ロジック
**含まれるストーリー**:
- ストーリー4.1: 敵の波による挑戦

**技術的境界**: 敵AI、パスファインディング、波生成
**外部依存**: ゲームセッション管理（ユニット1）

### ユニット5: UI・フィードバックシステムユニット
**責任**: ユーザーインターフェース、視覚・音響エフェクト
**含まれるストーリー**:
- ストーリー5.1: 即座の視覚・音響フィードバック
- ストーリー5.2: 明確なゲーム状態表示

**技術的境界**: レンダリング、アニメーション、音響管理
**外部依存**: 全ユニット（表示・フィードバック提供）

## ユニット依存関係図

```
ユニット1 (ゲームセッション・魔力) ←→ ユニット4 (敵システム)
        ↓ (魔力提供)
ユニット2 (カード管理) → ユニット3 (タワー戦闘) ←→ ユニット4 (敵システム)
        ↓                    ↓                    ↓
ユニット5 (UI・フィードバック) ←←←←←←←←←←←←←←←←←←←←←←←←←
```

## リスク評価

### 高リスク
- **ユニット3-4間の戦闘ロジック**: タワーと敵の相互作用が複雑
- **ユニット5の性能**: リアルタイム描画とアニメーションの最適化

### 中リスク  
- **ユニット1-2間の魔力システム**: 魔力消費とカードプレイの同期
- **ユニット2-3間のカード-タワー変換**: カード仕様からタワー生成の整合性
- **ユニット1のタイミング制御**: 3分タイマーと魔力生成の同期

### 低リスク
- **ユニット4の敵生成**: 比較的独立したロジック
- **ユニット1のスコア計算**: 単純な数値処理

## 開発・デプロイメント戦略

### 推奨開発順序
1. **ユニット1** (ゲームセッション) - 基盤システム
2. **ユニット2** (カード管理) - データ管理基盤  
3. **ユニット4** (敵システム) - 独立性が高い
4. **ユニット3** (タワー戦闘) - 複雑な相互作用
5. **ユニット5** (UI・フィードバック) - 統合・最適化

### 独立デプロイメント可能性
- **ユニット1, 2, 4**: 高い独立性
- **ユニット3**: 中程度（ユニット2, 4に依存）
- **ユニット5**: 低い（全ユニットに依存）